var Ct=Object.defineProperty;var Bt=(e,n,r)=>n in e?Ct(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;var ue=(e,n,r)=>(Bt(e,typeof n!="symbol"?n+"":n,r),r);import{R as V,r as u,j as t,u as I,N as re,a as St,m as At,d as ae,e as ne,Q as Ft,b as Se,c as h,B as x,T as D,L as K,f as Ae,I as kt,g as W,h as O,i as j,C as oe,k as fe,l as M,A as Dt,n as wt,o as _e,p as R,q as It,s as Tt,t as Fe,M as Lt,v as $e,D as Pt,w as U,x as H,y as me,z as ke,E as _,F as $t,G as Rt,H as Re,J as Nt,K as zt,O as Ye,P as qe,S as Wt,U as Ne,V as De,W as C,X as Mt,Y as we,Z as Ot,_ as jt,$ as Ve,a0 as ge,a1 as Ke,a2 as Y,a3 as Ut,a4 as T,a5 as Ht,a6 as _t,a7 as Yt,a8 as qt,a9 as Vt,aa as Kt,ab as Gt,ac as Qt,ad as Jt,ae as w,af as Zt,ag as Xt,ah as Ge,ai as xe,aj as en,ak as tn,al as nn,am as X,an as rn,ao as an,ap as on,aq as sn,ar as un,as as ze,at as ln,au as cn,av as dn,aw as pn,ax as hn,ay as fn,az as mn,aA as gn,aB as xn,aC as pe,aD as yn,aE as Qe,aF as Ce,aG as ce,aH as bn,aI as vn,aJ as En,aK as Cn,aL as Bn,aM as Sn,aN as Ie,aO as Je,aP as An,aQ as We,aR as Fn,aS as kn,aT as Dn,aU as wn,aV as In,aW as Tn,aX as Ln,aY as Pn,aZ as $n,a_ as Rn,a$ as Nn,b0 as zn}from"./vendor.06c9ad67.js";const Wn=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}};Wn();class Mn{constructor(){ue(this,"key","LOCAL_STORAGE_USER");ue(this,"data");ue(this,"callbacks");this.data=this.getDataFromStore(),this.callbacks=[]}bind(n){this.callbacks.push(n)}unbind(n){this.callbacks=this.callbacks.filter(r=>r!==n)}getAccessToken(){var n;return(n=this.data)==null?void 0:n.accessToken}getUser(){var n;return(n=this.data)==null?void 0:n.userInfo}updateUser(n){const r={...this.data.userInfo,...n};this.set({...this.data,userInfo:r})}clear(){this.data=void 0,localStorage.removeItem(this.key),this.callbacks.forEach(n=>n(this.data))}set(n){this.data=n,localStorage.setItem(this.key,JSON.stringify(n)),this.callbacks.forEach(r=>r(n))}getDataFromStore(){let n=localStorage.getItem(this.key);try{n&&(n=JSON.parse(n))}catch(r){n=null,console.error(r)}return n}}const N=new Mn,Ze=V.createContext(void 0);function ye(){return V.useContext(Ze)}function On({children:e}){const[n,r]=u.exports.useState(()=>N.getUser());return u.exports.useEffect(()=>{const o=a=>r(a==null?void 0:a.userInfo);return N.bind(o),()=>{N.unbind(o)}},[]),t(Ze.Provider,{value:n,children:e})}function Me({children:e}){const n=ye(),r=I();return n?n.registerFlag?e:t(re,{to:"/register",state:{from:r.pathname},replace:!0}):t(re,{to:"/login",state:{from:r.pathname},replace:!0})}var Xe="/assets/login-bg.c70c5da9.png",jn="/assets/login-logo.865ad1b8.png";const S=St.create({timeout:15e3,baseURL:"https://admin.huilaixue.cn/fc"});S.interceptors.request.use(e=>{const n=Date.now(),r=At(ae(n).format("YYYY-MM-DD HH:mm:ss")),o=N.getAccessToken();return e.headers.mac=r,o&&(e.headers["x-Authorization"]=o),e});S.interceptors.response.use(e=>{const{data:n}=e;return Object.prototype.hasOwnProperty.call(n,"respResult")&&n.respResult==="success"?n.respBody:Promise.reject(n)},e=>{var r,o,a;const n=((o=(r=e.response)==null?void 0:r.data)==null?void 0:o.message)||e.message;return((a=e.response)==null?void 0:a.status)===401&&N.clear(),ne(n,{variant:"error"}),Promise.reject(new Error(`:( ${n}`))});function Un(e){return S.post("/login/sendSms",e)}function Hn(e){return Object.prototype.hasOwnProperty.call(e,"phone")?S.post("/login/sms",e):S.post("/login/username",e)}function _n(e){const n={...e,grade:"13",deptId:29};return S.post("/student/register",n).then(()=>({...n,registerFlag:1}))}const et=new Ft({defaultOptions:{queries:{staleTime:1*60*1e3,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchInterval:!1,retry:!1}}});function Yn({login:e,isLoading:n}){var s,i;const{register:r,handleSubmit:o,formState:{errors:a}}=Se({defaultValues:{username:"13607148408",pass:"123456"}});return h(x,{component:"form",noValidate:!0,onSubmit:o(e),children:[t(D,{margin:"normal",variant:"standard",required:!0,fullWidth:!0,label:"\u8D26\u53F7",autoComplete:"tel",autoFocus:!0,helperText:(s=a.username)==null?void 0:s.message,error:!!a.username,...r("username",{required:"\u8D26\u53F7\u4E0D\u80FD\u4E3A\u7A7A"})}),t(D,{margin:"normal",variant:"standard",required:!0,fullWidth:!0,label:"\u5BC6\u7801",type:"password",autoComplete:"current-password",error:!!a.pass,helperText:(i=a.pass)==null?void 0:i.message,...r("pass",{required:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A"})}),t(K,{sx:{mt:2},variant:"contained",fullWidth:!0,type:"submit",loadingPosition:"start",startIcon:t(Ae,{}),loading:n,children:"\u767B\u5F55"})]})}function qn({onEnd:e}){const[n,r]=u.exports.useState(60);return u.exports.useEffect(()=>{n===0&&e()},[n,e]),u.exports.useEffect(()=>{const o=window.setInterval(()=>{r(a=>a-1)},1e3);return()=>{window.clearInterval(o)}},[]),t("span",{children:`${n}\u79D2\u540E\u53EF\u91CD\u53D1`})}function Vn({login:e,isLoading:n}){var d,f;const[r,o]=u.exports.useState(0),{trigger:a,getValues:s,register:i,handleSubmit:l,formState:{errors:c}}=Se({mode:"onChange"}),p=async()=>{await a("phone",{shouldFocus:!0})&&(await Un({phone:s("phone")}),o(1))};return h(x,{component:"form",noValidate:!0,onSubmit:l(e),children:[t(D,{margin:"normal",variant:"standard",required:!0,fullWidth:!0,label:"\u624B\u673A\u53F7",autoComplete:"tel",autoFocus:!0,helperText:(d=c.phone)==null?void 0:d.message,error:!!c.phone,...i("phone",{required:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"})}),t(D,{margin:"normal",variant:"standard",required:!0,fullWidth:!0,label:"\u9A8C\u8BC1\u7801",autoComplete:"off",InputProps:{endAdornment:t(kt,{position:"end",children:t(W,{disabled:r===1,onClick:p,size:"medium",variant:"text",children:r===1?t(qn,{onEnd:()=>o(2)}):`${r===2?"\u91CD\u65B0":""}\u83B7\u53D6\u9A8C\u8BC1\u7801`})})},error:!!c.code,helperText:(f=c.code)==null?void 0:f.message,...i("code",{required:"\u9A8C\u8BC1\u7801\u4E0D\u80FD\u4E3A\u7A7A"})}),t(K,{sx:{mt:2},variant:"contained",fullWidth:!0,type:"submit",loadingPosition:"start",startIcon:t(Ae,{}),loading:n,children:"\u767B\u5F55"})]})}function Kn(){const[e,n]=u.exports.useState(0),r=O(),o=I(),a=j(Hn,{onSuccess(s){var l;N.set(s),et.clear();const i=((l=o.state)==null?void 0:l.from)||"/";r(i,{replace:!0})}});return t(x,{sx:s=>({display:"flex",height:"100%",alignItems:"flex-start",backgroundImage:`url("${Xe}")`,backgroundSize:"cover",backgroundColor:"#fff",[s.breakpoints.down(444)]:{backgroundImage:"none"}}),children:h(oe,{maxWidth:"xs",sx:{display:"flex",flexDirection:"column",py:4,mt:12,backgroundColor:"#fff"},children:[t(x,{sx:{display:"flex",justifyContent:"center",mb:3},children:t("img",{style:{width:"85%"},src:jn,alt:""})}),h(fe,{value:e,onChange:(s,i)=>n(i),children:[t(M,{label:"\u5BC6\u7801\u767B\u5F55",value:0}),t(M,{label:"\u624B\u673A\u767B\u5F55",value:1})]}),e===0&&t(Yn,{login:a.mutate,isLoading:a.isLoading}),e===1&&t(Vn,{login:a.mutate,isLoading:a.isLoading})]})})}var Gn="/assets/logo.cb9b9edb.png";function Qn({children:e}){const n=ye(),[r,o]=u.exports.useState(null),a=i=>{o(i.currentTarget)},s=()=>{o(null)};return t(Dt,{position:"static",sx:{background:"linear-gradient(90deg, #ff630f, #ff870f)",position:"relative",zIndex:1},children:h(wt,{children:[e,t(_e,{href:"/",sx:{flex:"0 1 198px",height:"45px",backgroundImage:`url("${Gn}")`,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"left center"}}),t("span",{style:{flex:"1 1 0%"}}),t(R,{size:"large",color:"inherit",children:t(It,{badgeContent:0,color:"error",children:t(Tt,{})})}),t(R,{size:"large",sx:{p:0,ml:"12px"},onClick:a,color:"inherit",children:t(Fe,{children:n.realName[0]})}),h(Lt,{anchorEl:r,anchorOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(r),onClose:s,children:[t($e,{dense:!0,children:n.username}),t(Pt,{}),t($e,{dense:!0,onClick:()=>N.clear(),children:"\u9000\u51FA"})]})]})})}const Jn=[{key:"/alltextbook",label:"\u5168\u90E8\u8BFE\u7A0B",icon:t($t,{})},{key:"/textbook",label:"\u5DF2\u9009\u8BFE\u7A0B",icon:t(Rt,{})},{key:"/history",label:"\u5B66\u4E60\u8BB0\u5F55",icon:t(Re,{})},{key:"/exams",label:"\u73B0\u5728\u6D4B\u8BC4",icon:t(Nt,{})},{key:"/recordExam",label:"\u6D4B\u8BC4\u8BB0\u5F55",icon:t(zt,{})},{key:"/feedback",label:"\u5E08\u751F\u4E92\u52A8",icon:t(Re,{})}];function Oe({onClick:e}){const n=I(),r=O(),o=s=>{r(s.key),e==null||e()},a=n.pathname;return t(U,{sx:{width:240,px:2},component:"nav",children:Jn.map(s=>t(H,{disablePadding:!0,children:h(me,{selected:a===s.key,onClick:()=>o(s),sx:i=>({"&.Mui-selected":{color:i.palette.primary.main,backgroundColor:"transparent"}}),children:[t(ke,{sx:{minWidth:35,color:"inherit"},children:s.icon}),t(_,{primary:s.label})]})},s.key))})}function Zn(){const e=Ye(),n=qe(e.breakpoints.down("sm")),[r,o]=u.exports.useState(!1);return h(x,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[t(Qn,{children:n&&t(R,{color:"inherit",edge:"start",onClick:()=>o(!r),sx:{display:{sm:"none"}},children:t(Wt,{})})}),h(x,{sx:{display:"flex",flex:1,overflow:"hidden"},children:[n?t(Ne,{variant:"temporary",open:r,onClose:()=>o(!1),ModalProps:{keepMounted:!0},children:t(Oe,{onClick:()=>o(!1)})}):t(Ne,{variant:"permanent",PaperProps:{sx:{position:"relative",zIndex:0}},open:!0,children:t(Oe,{})}),t(De,{})]})]})}var z=(e=>(e.Chinese="001001",e.English="001002",e))(z||{});function Xn(e){return S.post("/study/textbook",{...e,authType:"2"})}function er(e="001002"){return S.post("/study/authtextbook",{subType:e})}function tr(e){return S.post("/study/textbook/unit",{id:e})}function nr(e){return S.post("/study/textbook/step",e)}const rr=e=>u.exports.createElement("svg",{width:160,height:160,viewBox:"0 0 160 160",...e},u.exports.createElement("defs",null,u.exports.createElement("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:"van-empty-5"},u.exports.createElement("stop",{stopColor:"#F2F3F5",offset:"0%"}),u.exports.createElement("stop",{stopColor:"#DCDEE0",offset:"100%"})),u.exports.createElement("linearGradient",{x1:"95%",y1:"48%",x2:"5.5%",y2:"51%",id:"van-empty-6"},u.exports.createElement("stop",{stopColor:"#EAEDF1",offset:"0%"}),u.exports.createElement("stop",{stopColor:"#DCDEE0",offset:"100%"})),u.exports.createElement("linearGradient",{y1:"45%",x2:"100%",y2:"54%",id:"van-empty-7"},u.exports.createElement("stop",{stopColor:"#EAEDF1",offset:"0%"}),u.exports.createElement("stop",{stopColor:"#DCDEE0",offset:"100%"}))),u.exports.createElement("defs",null,u.exports.createElement("linearGradient",{id:"van-empty-a",x1:"64%",y1:"100%",x2:"64%"},u.exports.createElement("stop",{stopColor:"#FFF",offset:"0%",stopOpacity:.5}),u.exports.createElement("stop",{stopColor:"#F2F3F5",offset:"100%"}))),u.exports.createElement("g",{opacity:.8},u.exports.createElement("path",{d:"M36 131V53H16v20H2v58h34z",fill:"url(#van-empty-a)"}),u.exports.createElement("path",{d:"M123 15h22v14h9v77h-31V15z",fill:"url(#van-empty-a)"})),u.exports.createElement("defs",null,u.exports.createElement("linearGradient",{id:"van-empty-b",x1:"64%",y1:"97%",x2:"64%",y2:"0%"},u.exports.createElement("stop",{stopColor:"#F2F3F5",offset:"0%",stopOpacity:.3}),u.exports.createElement("stop",{stopColor:"#F2F3F5",offset:"100%"}))),u.exports.createElement("g",{opacity:.8},u.exports.createElement("path",{d:"M87 6c3 0 7 3 8 6a8 8 0 1 1-1 16H80a7 7 0 0 1-8-6c0-4 3-7 6-7 0-5 4-9 9-9Z",fill:"url(#van-empty-b)"}),u.exports.createElement("path",{d:"M19 23c2 0 3 1 4 3 2 0 4 2 4 4a4 4 0 0 1-4 3v1h-7v-1l-1 1c-2 0-3-2-3-4 0-1 1-3 3-3 0-2 2-4 4-4Z",fill:"url(#van-empty-b)"})),u.exports.createElement("g",{transform:"translate(36 50)",fill:"none"},u.exports.createElement("g",{transform:"translate(8)"},u.exports.createElement("rect",{fill:"#EBEDF0",opacity:.6,x:38,y:13,width:36,height:53,rx:2}),u.exports.createElement("rect",{fill:"url(#van-empty-5)",width:64,height:66,rx:2}),u.exports.createElement("rect",{fill:"#FFF",x:6,y:6,width:52,height:55,rx:1}),u.exports.createElement("g",{transform:"translate(15 17)",fill:"url(#van-empty-6)"},u.exports.createElement("rect",{width:34,height:6,rx:1}),u.exports.createElement("path",{d:"M0 14h34v6H0z"}),u.exports.createElement("rect",{y:28,width:34,height:6,rx:1}))),u.exports.createElement("rect",{fill:"url(#van-empty-7)",y:61,width:88,height:28,rx:1}),u.exports.createElement("rect",{fill:"#F7F8FA",x:29,y:72,width:30,height:6,rx:1})));function tt({sx:e}){return h(x,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",...e},children:[t(rr,{}),t(C,{variant:"caption",color:"#969799",children:"\u6682\u65E0\u6570\u636E"})]})}function nt({error:e,sx:n}){return t(x,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",...n},children:t(C,{variant:"body1",color:"error",children:e.message||"\u52A0\u8F7D\u5931\u8D25"})})}const ar=e=>e===void 0||Array.isArray(e)&&e.length===0;function or(){return t(Mt,{in:!0,children:t(x,{sx:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:t(we,{})})})}function G(e){const{error:n,isLoading:r,isSuccess:o,children:a,data:s,sx:i,loading:l=t(or,{})}=e,c=u.exports.useRef(),[p,d]=u.exports.useState(!1);u.exports.useLayoutEffect(()=>(r?c.current=window.setTimeout(()=>{d(!0)},100):(window.clearTimeout(c.current),d(!1)),()=>{window.clearTimeout(c.current)}),[r]);const f=e.isEmpty===void 0?ar(s):e.isEmpty;let m=a;return n?m=t(nt,{error:n}):o&&f&&(m=t(tt,{})),h(x,{sx:{position:"relative",minHeight:100,opacity:p?.5:void 0,...i},children:[m,p&&l]})}function sr({replaceBreadcrumbs:e}){const n=I();let r=(Ot(bt,n)||[]).filter(a=>a.route.breadcrumbName).map(a=>({name:a.route.breadcrumbName,path:a.pathname}));e&&(r=e(r));const o=r.map((a,s)=>s!==r.length-1?t(_e,{underline:"hover",color:"inherit",href:a.path,children:a.name},a.path):t(C,{variant:"h6",fontSize:"1rem",color:"text.primary",children:a.name},a.path));return t(jt,{"aria-label":"breadcrumb",children:o})}function q({children:e,action:n,contentStyle:r,...o}){return h(x,{sx:{display:"flex",flexDirection:"column",flex:1,overflowX:"hidden"},children:[h(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottomColor:"divider",borderBottomWidth:1,borderBottomStyle:"solid"},children:[t(sr,{...o}),n]}),t(x,{sx:{display:"flex",flexDirection:"column",flex:1,overflow:"auto",...r},children:e})]})}function be(){const[e,n]=Ve();return[e.get("type")||z.English,a=>{n({type:a})}]}function rt(){const[e,n]=be();return h(fe,{variant:"scrollable",value:e,onChange:(o,a)=>{n(a)},children:[t(M,{label:"\u82F1\u8BED\u8BFE\u7A0B",value:z.English}),t(M,{label:"\u6C49\u8BED\u8BFE\u7A0B",value:z.Chinese})]})}function at({data:e}){const[n]=be(),r=I();return t(U,{children:e.map((o,a)=>t(H,{divider:a!==e.length-1,disablePadding:!0,children:h(me,{component:ge,to:`${r.pathname}/${n}/${o.id}`,state:{title:o.label},children:[t(Ke,{children:t(Fe,{variant:"square",src:o.imageUrl})}),t(_,{primary:o.label,secondary:`\u5171 ${o.totalUnit} \u8BFE`})]})},o.id))})}function ir(){var o;const[e]=be(),n=Y(["owntextbooks",e],()=>er(e)),r=((o=n.data)==null?void 0:o.textBooks)||[];return h(q,{children:[t(rt,{}),t(G,{sx:{flex:1,overflow:"auto"},isEmpty:r.length===0,...n,children:t(at,{data:r})})]})}function ur(){var p,d;const[e]=be(),[n,r]=u.exports.useState(0),o=(f,m)=>{r(m-1)},a=10,s=Y(["alltextbooks",e,n],()=>Xn({subType:e,page:n,size:a})),i=((p=s.data)==null?void 0:p.content)||[],l=((d=s.data)==null?void 0:d.totalElements)||0,c=Math.floor(l/a)||1;return h(q,{children:[t(rt,{}),t(G,{sx:{flex:1,overflow:"auto"},isEmpty:i.length===0,...s,children:t(at,{data:i})}),t(Ut,{sx:{display:"flex",justifyContent:"flex-end",m:1},color:"primary",variant:"outlined",shape:"rounded",count:c,page:n+1,onChange:o})]})}function ot(e){return typeof e=="object"&&e!==null}function st(e){return new Promise(n=>{const r=new FileReader;r.onload=()=>n(r.result),r.readAsDataURL(e)})}function Te(e,n){const r=o=>o.replace(/[\p{P}]/gu,"").replace(/\s{2,}/g," ");return r(e).toLowerCase()===r(n).toLowerCase()}function it(e){let n=Math.floor(e/60);const r=Math.floor(n/60);n%=60;const o=e%60;return r?`${r}\u65F6${n}\u5206`:n?`${n}\u5206${o}\u79D2`:`${o}\u79D2`}function lr(){const e=I(),n=O(),{textbookId:r,unitId:o,type:a}=T(),s=e.pathname.match(/^\/\w+/)[0],i=()=>[{path:`${s}?type=${a}`,name:s==="/textbook"?"\u5DF2\u9009\u8BFE\u7A0B":"\u5168\u90E8\u8BFE\u7A0B"},{path:e.pathname,name:ot(e.state)?e.state.title:""}],c=Y(["textbook",r],()=>tr(r)).data||[],p=u.exports.useCallback(d=>{n(`unit/${d}`,{replace:!0,state:e.state})},[]);return u.exports.useEffect(()=>{if(!o&&c.length){const d=c.find(f=>f.selected==="1")||c[0];p(d.id)}},[o,c]),h(q,{replaceBreadcrumbs:i,children:[t(fe,{variant:"scrollable",value:o||!1,onChange:(d,f)=>p(f),children:c.map(d=>t(M,{label:d.title,value:d.id},d.id))}),t(De,{})]})}var A=(e=>(e.Audio="002001",e.Video="002002",e.Image="002003",e))(A||{}),B=(e=>(e.Reading="005006",e.WriteWord="005001",e.WriteSentenceByAudio="005015",e.WriteSentenceByTranslation="005018",e.WriteFullText="005020",e.SortSentence="005009",e.SortTranslation="005010",e.SortSentenceByAudio="005008",e.SortWordByAudio="005007",e.SortWordByTranslation="005022",e.Selection="005005",e.SelectionByAudio="005002",e.SelectionByContent="005004",e.SelectionImageByAudio="005003",e.SpeakingByTranslation="005017",e.SpeakingByImage="005012",e.SpeakingByContent="005011",e.SpeakingByFullword="005019",e.SpeakingRepeat="005016",e))(B||{});function cr(e){return S.post("/study/info/search",e)}function dr(e){return S.post("/study/confirm",e)}function ut({language:e,id:n,audioBase64:r,type:o}){return e=e===z.English?"en_us":"zh-cn",r=r.replace(/^data:audio\/.*;base64,/,""),S.post(`/study/check/${o}`,{language:e,audioBase64:r,id:n})}function pr({value:e="",...n}){return h("div",{style:{display:"inline",position:"relative",margin:"0 4px",borderBottom:"1px solid #ff870f"},children:[t("span",{style:{display:"inline-block",visibility:"hidden",minWidth:"60px"},children:e||"\u6D4B\u8BD5"}),t("input",{...n,value:e,style:{position:"absolute",left:0,top:-1,width:"100%",height:"100%",padding:"0 0",border:0,outline:0,font:"inherit",fontSize:"inherit",color:"currentcolor",lineHeight:"inherit",zIndex:1}})]})}function lt({content:e,value:n,onChange:r}){const o=i=>l=>{const c=n.slice();c[i]=l.target.value,r(c)};let a=-1;const s=e.split(/\n/g).map((i,l)=>{const c=Ht(i,"#",()=>(a+=1,t(pr,{value:n[a],onChange:o(a)})));return t(C,{variant:"study",marginBottom:1,children:c},l)});return t("div",{children:s})}function ct({title:e,primary:n}){const r=O();return t(x,{sx:{py:1,...n?{backgroundColor:"primary.main",color:"#fff"}:{borderBottom:1,borderColor:"divider"}},children:h(oe,{maxWidth:"lg",sx:{position:"relative",display:"flex",alignItems:"center"},children:[t(R,{onClick:()=>r(-1),sx:{position:"absolute",color:"inherit",left:2},children:t(_t,{})}),t(C,{variant:"h6",sx:{flex:1,textAlign:"center"},children:e})]})})}function dt({title:e="",open:n,children:r,onClose:o,onConfirm:a,confirmLoading:s=!1,cancelButtonText:i="\u53D6\u6D88",confirmButtonText:l="\u786E\u5B9A",...c}){return h(Yt,{...c,fullWidth:!0,maxWidth:"sm",open:n,onClose:o,children:[h(qt,{children:[e,t(R,{"aria-label":"close",onClick:o,sx:{position:"absolute",right:8,top:8,color:p=>p.palette.grey[500]},children:t(Vt,{})})]}),t(Kt,{children:r}),h(Gt,{disableSpacing:!0,sx:{py:1},children:[t(W,{onClick:o,children:i}),a&&t(K,{loading:s,onClick:a,children:l})]})]})}const hr=V.forwardRef(function(n,r){return t(Qt,{direction:"up",ref:r,...n})});function pt(e){const n=Ye(),r=qe(n.breakpoints.down("md"));return t(dt,{TransitionComponent:hr,fullScreen:r,...e})}function fr(){const{textbookId:e,unitId:n}=T(),r=Y(["unit",e,n],()=>nr({textbookId:e,unitId:n}),{enabled:!!n}),o=r.data||[];return h(w,{children:[t(G,{sx:{flex:1,overflow:"auto"},...r,children:t(U,{children:o.map(a=>{const s=a.finished==="0";return t(H,{disablePadding:!0,children:h(me,{component:ge,to:he({stepId:a.stepNum,stepValue:a.stepValue}),disabled:s,children:[t(ke,{sx:{minWidth:0,mr:1.5},children:s?t(Zt,{}):t(Xt,{sx:{color:"primary.main"}})}),t(_,{primary:a.title})]})},a.stepNum+a.stepValue)})})}),t(De,{context:o})]})}function ht(){return Jt()}const mr=()=>{};function L({title:e,tips:n,isLoading:r=!1,isWrong:o=!1,onRight:a,onCancel:s,onConfirm:i,confirmProps:l,cancelText:c="\u4E0A\u4E00\u6B65",confirmText:p="\u786E\u5B9A",children:d,footer:f}){const m=ht(),{stepId:g}=T(),v=m.find(E=>String(E.stepNum)===g),y=v?v.title:e;return h(Ge,{sx:{display:"flex",height:"100%",flexDirection:"column"},children:[t(ct,{primary:!0,title:y}),t(oe,{maxWidth:"lg",sx:{flex:1,overflow:"auto",py:4},children:d}),t(xe,{p:2,spacing:2,direction:"row",justifyContent:"center",alignItems:"center",flexWrap:"wrap",children:h(w,{children:[f,t(K,{loading:r,size:"large",variant:"contained",onClick:i,...l,children:p}),s&&t(W,{size:"large",variant:"outlined",onClick:s,children:c})]})}),n&&t(pt,{title:"\u63D0\u793A",cancelButtonText:"\u77E5\u9053\u4E86",open:o,onClose:a||mr,children:n})]})}function ft({data:e,reset:n}){const[r,o]=u.exports.useState(0),a=e[r],s=()=>{const p=r+1;o(p),n==null||n(e[p])},i=()=>{const p=r-1;o(p),n==null||n(e[p])},l=r===0,c=r===e.length-1;return{current:a,next:s,previous:i,isFirst:l,isLast:c,setIndex:o,index:r}}function gr(){const{textbookId:e,unitId:n,stepId:r,stepValue:o}=T(),a=ht(),s=O(),i=I(),l=u.exports.useRef(0);u.exports.useEffect(()=>{l.current=Date.now()},[]);const{mutate:c,isLoading:p}=j(dr,{async onSuccess(){try{const f=a.findIndex(m=>m.stepNum===r);if(f!==a.length-1){const m=a[f+1],g=i.pathname.replace(he({stepId:r,stepValue:o}),he({stepId:m.stepNum,stepValue:m.stepValue}));s(g,{replace:!0})}else s(-1)}catch{s(-1)}}});return{submit:()=>{const f=Date.now(),m=Math.round((f-l.current)/1e3);c({textbookId:e,unitId:n,stepNum:r,stepValue:o,studyTime:m,startTime:ae(l.current).format("YYYY-MM-DD HH:mm:ss"),endTime:ae(f).format("YYYY-MM-DD HH:mm:ss")})},isLoading:p}}function P({data:e,reset:n,needRestart:r=!0,validateText:o="\u8BF7\u731C\u7740\u7B54\u5B8C\u5404\u4E2A\u95EE\u9898",validate:a=()=>!1,isCorrect:s}){const[i,l]=u.exports.useState(!1),[c,p]=u.exports.useState([]),[d,f]=u.exports.useState([]),{current:m,isLast:g,next:v,setIndex:y}=ft({data:c.length?c:e,reset:n}),{submit:E,isLoading:b}=gr();return{current:m,isLoading:b,onConfirm:async()=>{if(a(m)){ne(o,{variant:"warning",autoHideDuration:2e3});return}const ie=await(s||(()=>!0))(m);typeof s=="function"&&(ie?ne("\u6B63\u786E",{variant:"success"}):ne("\u9519\u8BEF",{variant:"error"})),ie?g?d.length?(y(0),n==null||n(m),p(d),f([])):E():v():(n==null||n(m),l(!0),r&&!d.includes(m)&&f([...d,m]))},isWrong:i,onRight:()=>l(!1)}}function se({attach:e,defaultIndex:n=0}){var v;const r=u.exports.useRef(null),o=u.exports.useRef(null),a=u.exports.useRef(null),s=(Array.isArray(e)?e:[e]).filter(Boolean),i=s.find(y=>y.attachType===A.Image),l=s.find(y=>y.attachType===A.Audio),c=s.find(y=>y.attachType===A.Video),[p,d]=u.exports.useState((v=s[n])==null?void 0:v.attachType),f=y=>{if(y===p){d(void 0);return}d(y),(y===A.Image||y===A.Video)&&X.isEnabled&&(y===A.Image?X.request(r.current):X.request(a.current))},m=y=>{const{target:E}=y;X.isEnabled&&X.toggle(E)},g=s.length<=1&&n>=0;return h(x,{children:[!g&&h(xe,{direction:"row",spacing:2,justifyContent:"center",children:[i&&t(R,{size:"large",color:p===A.Image?"primary":"default",onClick:()=>f(A.Image),children:t(en,{fontSize:"inherit"})}),l&&t(R,{size:"large",color:p===A.Audio?"primary":"default",onClick:()=>f(A.Audio),children:t(tn,{fontSize:"inherit"})}),c&&t(R,{size:"large",color:p===A.Video?"primary":"default",onClick:()=>f(A.Video),children:t(nn,{fontSize:"inherit"})})]}),h(x,{sx:{mb:p?1:0},display:"flex",justifyContent:g?"start":"center",children:[i&&t("img",{style:{display:p===A.Image?"block":"none",maxWidth:300},alt:"study",ref:r,src:i.attachUrl,onClick:m}),l&&t("audio",{ref:o,style:{display:p===A.Audio?"block":"none"},controls:!0,src:l.attachUrl}),c&&t("video",{ref:a,style:{display:p===A.Video?"block":"none"},controls:!0,src:c.attachUrl})]})]})}function mt({content:e,attach:n}){return h(x,{children:[n&&t(se,{attach:n}),e&&t(C,{variant:"study",children:e})]})}function Q({data:e,mediaId:n="id",baseKey:r,defaultIndex:o,mediaFirst:a=!1}){const s=Array.isArray(r)?r:[r],i=s.filter(d=>!/Attach/.test(String(d))),l=s.filter(d=>/Attach/.test(String(d))),c=i.map(d=>{const f=e[d];return typeof f=="string"?t(C,{variant:"study",mb:1,children:f},String(d)):null}),p=l.length?t(se,{attach:l.map(d=>e[d]),defaultIndex:o},e[n]):null;return a?h(w,{children:[p,c]}):h(w,{children:[c,p]})}function xr({data:e,title:n}){const[r,o]=u.exports.useState([]),a=()=>o([]),{current:s,...i}=P({data:e,reset:a,validate:l=>r.length!==l.answer.split("|").length,isCorrect:l=>r.map(c=>c.trim().toLowerCase()).join("|")===l.answer.toLowerCase()});return h(L,{tips:t(mt,{...s.tips}),title:n,...i,children:[t(Q,{data:s,baseKey:["imageAttach","audioAttach","videoAttach"],defaultIndex:-1}),t(lt,{content:s.content,value:r,onChange:o})]})}function ve({current:e}){const n=[{key:"translation",icon:t(rn,{fontSize:"inherit"}),text:e.translation},{key:"content",icon:t(an,{fontSize:"inherit"}),text:e.content},{key:"analysis",icon:t(on,{fontSize:"inherit"}),text:e.analysis}];return h(w,{children:[t(se,{defaultIndex:-1,attach:[e.imageAttach,e.audioAttach,e.videoAttach]},e.id),t(U,{children:n.map(r=>h(H,{alignItems:"flex-start",children:[t(ke,{sx:{color:"primary.main",typography:"study"},children:r.icon}),t(_,{primary:r.text,primaryTypographyProps:{variant:"study",component:"p"}})]},r.key))})]})}function yr({data:e,title:n}){const{current:r,...o}=P({data:e});return t(L,{title:n,...o,children:t(ve,{current:r})})}function br({item:e,renderItem:n}){const{setNodeRef:r,attributes:o,listeners:a,transform:s,transition:i}=sn({id:e.id}),l={touchAction:"none",cursor:"grab",transform:s?`translate3d(${s.x}px, ${s.y}px, 0)`:void 0,transition:i};return n({setNodeRef:r,attributes:o,listeners:a,style:l,item:e})}function vr({items:e,setItems:n,renderItem:r,strategy:o}){const a=un(ze(fn),ze(hn,{coordinateGetter:pn}));return t(ln,{sensors:a,collisionDetection:cn,onDragEnd:i=>{const{active:l,over:c}=i;if(c&&l.id!==c.id){const p=e.findIndex(f=>f.id===l.id),d=e.findIndex(f=>f.id===c.id);n(mn(e,p,d))}},children:t(dn,{items:e,strategy:o,children:e.map(i=>t(br,{item:i,renderItem:r},i.id))})})}function ee({data:e,title:n,baseKey:r,vertical:o=!1}){const[a,s]=u.exports.useState(null),i=()=>s(null),l=o===!1,{current:c,...p}=P({data:e,reset:i,needRestart:l,isCorrect:f=>{const m=f.options.slice().sort((v,y)=>+v.value-+y.value).map(v=>v.content).join(""),g=(a||f.options).map(v=>v.content).join("");return m===g}}),d=a||c.options.map(f=>({id:f.value,content:f.content}));return h(L,{tips:o?void 0:t(ve,{current:c}),title:n,...p,children:[r&&t(Q,{data:c,baseKey:r}),t(x,{sx:{display:"flex",flexWrap:"wrap",flexDirection:o?"column":"row"},children:t(vr,{strategy:o?gn:void 0,items:d,setItems:s,renderItem:({item:f,listeners:m,attributes:g,setNodeRef:v,style:y})=>t(Ge,{variant:"outlined",ref:v,style:y,sx:o?{p:"0.5em",my:1}:{p:"0.5em",mr:"1px"},...m,...g,children:f.content})})})]})}function Er({options:e,value:n,onChange:r}){return t(xn,{children:e.map(o=>t(pe,{control:t(yn,{checked:n.indexOf(o.value)!==-1,onChange:()=>{const a=n.slice(),s=a.findIndex(i=>i===o.value);s===-1?a.push(o.value):a.splice(s,1),r(a)}}),label:o.label},o.value))})}function gt({value:e,onChange:n,options:r}){return t(Qe,{value:e,onChange:o=>n(o.target.value),children:r.map(o=>t(pe,{label:o.label,value:o.value,control:t(Ce,{})},o.value))})}function le({data:e,title:n,baseKey:r,multiple:o=!1}){const[a,s]=u.exports.useState(""),i=()=>s(""),{current:l,...c}=P({data:e,reset:i,validate:()=>a==="",isCorrect:d=>a===d.answer}),p=ce.exports.uniqBy(l.options.map(d=>({label:d.type==="006002"?t("img",{src:d.content,alt:d.content,height:"160"}):d.content,value:d.value})),"value");return h(L,{tips:l.tips&&t(mt,{...l.tips}),title:n,...c,children:[t(Q,{mediaFirst:o,data:l,baseKey:r}),o?t(Er,{value:a?a.split("|"):[],onChange:d=>s(d.sort().join("|")),options:p}):t(gt,{value:a,onChange:s,options:p})]})}function je({data:e,title:n,baseKey:r}){const[o,a]=u.exports.useState(""),s=()=>a(""),{current:i,...l}=P({data:e,reset:s,validateText:"\u7B54\u6848\u4E0D\u80FD\u4E3A\u7A7A",validate:()=>o.trim()==="",isCorrect:p=>Te(o,p.content)});return h(L,{tips:t(ve,{current:i}),title:n,...l,children:[t(Q,{data:i,baseKey:r}),t(D,{fullWidth:!0,multiline:!0,value:o,onChange:p=>{a(p.target.value)},variant:"standard"})]})}function Cr({data:e,title:n}){const[r,o]=u.exports.useState(!1),[a,s]=u.exports.useState(""),i=()=>s(""),{current:l,isLoading:c,onConfirm:p,...d}=P({data:e,reset:i,validateText:"\u7B54\u6848\u4E0D\u80FD\u4E3A\u7A7A",validate:()=>a.trim()==="",isCorrect:g=>Te(a,g.content)}),f=e.indexOf(l),m=g=>{s(g.target.value)};return t(L,{tips:t(ve,{current:l}),title:n,isLoading:c,onConfirm:r?p:()=>o(!0),confirmText:r?"\u63D0\u4EA4":"\u77E5\u9053\u4E86",...d,children:r?e.slice(0,f+1).map((g,v)=>v===f?h(C,{component:"div",variant:"study",sx:{display:"flex"},children:[g.character&&`${g.character}: `,t(D,{sx:{flex:1},multiline:!0,value:a,onChange:m,onBlur:p,variant:"standard"})]},g.id):t(C,{gutterBottom:!0,variant:"study",children:g.character?`${g.character}: ${g.content}`:g.content},g.id)):e.map(g=>t(C,{gutterBottom:!0,variant:"study",children:g.character?`${g.character}: ${g.content}`:g.content},g.id))})}const te=new bn({sampleBits:16,sampleRate:16e3,numChannels:1,compiling:!1});function Le({url:e,value:n,onChange:r}){const[o,a]=u.exports.useState("inactive"),[s,i]=u.exports.useState(0),[l,c]=u.exports.useState(""),p=u.exports.useRef(),[d]=u.exports.useState(()=>new Audio),f=async()=>{await te.stop();const E=te.getWAVBlob();r(E)},m=()=>{o==="paused"?te.resume():o==="recording"?(f(),a("inactive")):(r(void 0),te.start().then(()=>{a("recording")}))};u.exports.useEffect(()=>()=>{d.pause(),te.destroy()},[]);const g=()=>{l==="play"?d.pause():d.play()};u.exports.useEffect(()=>(o==="recording"?p.current=window.setInterval(()=>{i(E=>E+1)},1e3):o!=="paused"&&i(0),()=>{window.clearInterval(p.current)}),[o]),u.exports.useEffect(()=>{const E=d;if(n){const b=[],k=window.URL.createObjectURL(n);e&&b.push(e),b.push(k);let $=0;const J=ce.exports.debounce(c,50);E.addEventListener("play",()=>{J("play")}),E.addEventListener("pause",()=>{J("pause")}),E.addEventListener("ended",()=>{$=($+1)%b.length,E.src=b[$],E.play()}),E.loop=!1,E.src=b[$],E.play()}return()=>{E.pause()}},[n,e]);const v=ce.exports.padStart(String(s/60|0),2,"0"),y=ce.exports.padStart(String(s%60),2,"0");return h(w,{children:[t(W,{size:"large",variant:"outlined",startIcon:l==="play"?t(vn,{fontSize:"large"}):t(En,{fontSize:"large"}),disabled:!n,onClick:g,children:l==="play"?"\u6682\u505C":"\u64AD\u653E"}),t(W,{size:"large",variant:"outlined",startIcon:o==="recording"?t(Cn,{fontSize:"large"}):t(Bn,{fontSize:"large"}),onClick:m,children:o==="recording"?`${v}:${y}`:n?"\u91CD\u5F55":"\u5F55\u97F3"})]})}function Ee({data:e,title:n,baseKey:r}){var l;const[o,a]=u.exports.useState(),{current:s,...i}=P({data:e,validateText:"\u8BF7\u5148\u5F55\u97F3",validate:()=>o===void 0,reset:()=>a(void 0)});return t(L,{footer:t(Le,{value:o,onChange:a,url:(l=s.audioAttach)==null?void 0:l.attachUrl}),confirmText:"\u8BFB\u7684\u4E0D\u9519",title:n,...i,children:t(Q,{data:s,baseKey:r})})}function xt({audioAttach:e,words:n=[]}){const[r]=u.exports.useState(()=>new Audio),o=a=>{r.pause(),r.loop=!1,r.src=a,r.play()};return u.exports.useEffect(()=>()=>{r.pause()},[]),h(w,{children:[t(se,{attach:e}),t(C,{gutterBottom:!0,children:n.length>0?"\u70B9\u51FB\u4E0B\u9762\u5404\u8BCD\u64AD\u8BE5\u8BCD\u97F3\u9891":"\u8BED\u97F3\u8BC6\u522B\u672A\u901A\u8FC7"}),t(xe,{direction:"row",children:n.map(a=>t(W,{onClick:()=>o(a.audioUrl),variant:"text",children:a.word},a.word))})]})}function Br({data:e,title:n,baseKey:r}){var m,g;const{type:o,stepValue:a}=T(),[s,i]=u.exports.useState(),l=j(ut),c=async v=>{const y=await st(s);return(await l.mutateAsync({type:parseInt(a,10),id:v.id,language:o,audioBase64:y})).status==="1"},{current:p,isLoading:d,...f}=P({data:e,validateText:"\u8BF7\u5148\u5F55\u97F3",validate:()=>s===void 0,isCorrect:c});return t(L,{footer:t(Le,{onChange:i,value:s,url:(m=p.audioAttach)==null?void 0:m.attachUrl}),confirmProps:{disabled:!s},confirmText:"\u63D0\u4EA4",title:n,isLoading:d||l.isLoading,tips:t(xt,{audioAttach:p.audioAttach,words:(g=l.data)==null?void 0:g.words}),...f,children:t(Q,{data:p,baseKey:r})})}function Sr({data:e,title:n}){var E;const{type:r,stepValue:o}=T(),[a,s]=u.exports.useState(!1),[i,l]=u.exports.useState(),c=()=>l(void 0),p=j(ut),d=async b=>{const k=await st(i);return(await p.mutateAsync({type:parseInt(o,10),id:b.id,language:r,audioBase64:k})).status==="1"},{current:f,isLoading:m,onConfirm:g,...v}=P({data:e,reset:c,validateText:"\u8BF7\u5148\u5F55\u97F3",validate:()=>i===void 0,isCorrect:d}),y=e.indexOf(f);return t(L,{tips:t(xt,{audioAttach:f.audioAttach,words:(E=p.data)==null?void 0:E.words}),title:n,confirmProps:{disabled:a&&!i},footer:a?t(Le,{value:i,onChange:l},f.id):void 0,isLoading:m||p.isLoading,onConfirm:a?g:()=>s(!0),confirmText:a?"\u63D0\u4EA4":"\u77E5\u9053\u4E86",...v,children:a?e.slice(0,y+1).map((b,k)=>k===y?t(C,{component:"div",variant:"study",sx:{display:"flex"},children:b.character&&`${b.character}: `},b.id):t(C,{gutterBottom:!0,variant:"study",children:b.character?`${b.character}: ${b.content}`:b.content},b.id)):e.map(b=>t(C,{gutterBottom:!0,variant:"study",children:b.character?`${b.character}: ${b.content}`:b.content},b.id))})}const Ue={[B.Reading]:t(yr,{title:"\u770B\u548C\u542C",data:[]}),[B.WriteWord]:t(xr,{title:"\u586B\u7A7A",data:[]}),[B.WriteSentenceByAudio]:t(je,{title:"\u53E5\u5B50\u542C\u5199",data:[],baseKey:"audioAttach"}),[B.WriteSentenceByTranslation]:t(je,{title:"\u636E\u8BD1\u5199\u6587",data:[],baseKey:"translation"}),[B.WriteFullText]:t(Cr,{title:"\u9ED8\u5199",data:[]}),[B.SortSentence]:t(ee,{title:"\u6392\u53E5\u6210\u7BC7",data:[],vertical:!0}),[B.SortTranslation]:t(ee,{title:"\u8BD1\u6587\u6392\u5E8F",data:[],vertical:!0,baseKey:["imageAttach","audioAttach","videoAttach"]}),[B.SortSentenceByAudio]:t(ee,{title:"\u636E\u97F3\u6392\u53E5",data:[],vertical:!0,baseKey:"audioAttach"}),[B.SortWordByAudio]:t(ee,{title:"\u636E\u97F3\u6392\u8BCD",data:[],baseKey:"audioAttach"}),[B.SortWordByTranslation]:t(ee,{title:"\u636E\u8BD1\u6392\u8BCD",data:[],baseKey:"translation"}),[B.Selection]:t(le,{title:"\u5E38\u89C4\u9009\u62E9",data:[],multiple:!0,baseKey:["content","imageAttach","audioAttach","videoAttach"]}),[B.SelectionByAudio]:t(le,{title:"\u636E\u97F3\u9009\u6587",data:[],baseKey:"audioAttach"}),[B.SelectionByContent]:t(le,{title:"\u636E\u6587\u9009\u62E9",data:[],baseKey:"content"}),[B.SelectionImageByAudio]:t(le,{title:"\u636E\u97F3\u9009\u56FE",data:[],baseKey:"audioAttach"}),[B.SpeakingByTranslation]:t(Ee,{title:"\u636E\u8BD1\u8BF4\u6587",data:[],baseKey:"translation"}),[B.SpeakingByImage]:t(Ee,{title:"\u8BF4\u56FE",data:[],baseKey:"imageAttach"}),[B.SpeakingRepeat]:t(Ee,{title:"\u53E5\u5B50\u590D\u8FF0",data:[],baseKey:["audioAttach","content"]}),[B.SpeakingByContent]:t(Br,{title:"\u8BFB\u53E5\u5B50",data:[],baseKey:"content"}),[B.SpeakingByFullword]:t(Sr,{title:"\u80CC\u8BF5",data:[]})};function Ar(){const{textbookId:e,unitId:n,stepId:r,stepValue:o}=T(),a=Y(["study",e,n,r,o],()=>cr({textbookId:e,unitId:n,stepId:r,stepValue:o})),{data:s}=a;let i=null;return Ue[o]?s&&(i=V.cloneElement(Ue[o],{data:s})):i=t("span",{children:"\u6682\u4E0D\u652F\u6301"}),t(x,{sx:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:100,background:"#fff"},children:t(G,{sx:{height:"100%"},...a,children:i})})}function Fr(e={page:0,size:10}){return S.post("/study/record",e)}function kr(e={page:0,size:10}){return S.post("/exam/record",e)}function yt(e){return h(x,{sx:{position:"relative",display:"inline-flex"},children:[t(we,{variant:"determinate",color:e.value===100?"success":"primary",...e}),t(x,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:t(C,{variant:"caption",component:"div",color:"text.secondary",children:`${Math.round(e.value)}%`})})]})}function Pe({fetchNextPage:e,children:n,hasChildren:r,isLoading:o,hasNextPage:a,error:s}){return t(Sn,{loadMore:e,hasMore:!s&&(a===void 0?o:a),loader:t(x,{sx:{display:"flex",justifyContent:"center",my:1},children:t(we,{})},"loader"),useWindow:!1,children:s?t(nt,{error:s}):!o&&!r?t(tt,{}):n})}const Dr=e=>{if(!e||e.length===0)return[];const n=new Map;return e.forEach(r=>{n.has(r.lastDoTime)||n.set(r.lastDoTime,[]),n.get(r.lastDoTime).push(r)}),[...n]};function wr(){var o;const e=Ie(["studyRecord"],({pageParam:a=0})=>Fr({page:a,size:10}),{getNextPageParam:a=>{if(a.page<a.totalPages-1)return a.page+1}}),n=((o=e.data)==null?void 0:o.pages.reduce((a,s)=>a.concat(s.content),[]))||[],r=Dr(n);return t(q,{children:t(Pe,{fetchNextPage:()=>e.fetchNextPage(),hasNextPage:e.hasNextPage,isLoading:e.isLoading,hasChildren:n.length>0,children:t(U,{children:r.map((a,s)=>t(x,{component:"li",sx:{borderBottom:s===r.length-1?0:1,borderBottomColor:"divider"},children:h("ul",{style:{padding:0,margin:0},children:[t(Je,{sx:{lineHeight:"36px"},children:a[0]}),a[1].map((i,l)=>h(H,{children:[t(_,{sx:{whiteSpace:"pre"},primary:`${i.textbookName}  /  ${i.unitName}`,secondaryTypographyProps:{display:"flex",flexWrap:"wrap"},secondary:h(w,{children:[h(x,{component:"span",children:["\u5355\u5143\u5F97\u5206: ",i.onlineScore]}),h(x,{component:"span",sx:{mx:1},children:["\u8BFE\u7A0B\u5F97\u5206: ",i.onlineAllScore]}),h(x,{component:"span",children:["\u5B66\u65F6: ",it(parseInt(i.studyTime,10))]})]})}),t(yt,{value:parseInt(i.studyRate,10)})]},`${a[0]}-${l}`))]})},`${a[0]}`))})})})}function Ir(e){return S.post("common/feedback/add",{content:e})}function Tr(e){return S.post("common/feedback/search",e)}function Lr(){var f;const e=Ie(["feedback"],({pageParam:m=0})=>Tr({page:m,size:10}),{getNextPageParam:m=>{if(m.page<m.totalPages-1)return m.page+1}}),n=((f=e.data)==null?void 0:f.pages.reduce((m,g)=>m.concat(g.content),[]))||[],[r,o]=u.exports.useState(!1),[a,s]=u.exports.useState(""),[i,l]=u.exports.useState(!1),c=j(Ir),p=()=>{o(!1),s(""),l(!1)},d=async()=>{a?(await c.mutateAsync(a),e.refetch(),p()):l(!0)};return h(q,{contentStyle:{bgcolor:"grey.100"},action:t(W,{variant:"outlined",onClick:()=>o(!0),children:"\u53D1\u7ED9\u8001\u5E08"}),children:[t(Pe,{fetchNextPage:()=>e.fetchNextPage(),hasNextPage:e.hasNextPage,isLoading:e.isLoading,hasChildren:n.length>0,children:n.map(m=>t(An,{sx:{m:1.5},elevation:1,children:h(We,{children:[t(C,{sx:{fontSize:14},color:"text.secondary",children:m.createTime}),t(C,{sx:{fontSize:16},variant:"h6",children:m.recontent||"\u7A7A"}),m.response&&h(We,{sx:{bgcolor:"grey.100",mt:1},children:[t(C,{sx:{fontSize:14},color:"text.secondary",children:m.updateTime}),t(C,{sx:{fontSize:16},variant:"body2",children:m.response})]})]})},m.id))}),t(dt,{title:"\u53D1\u7ED9\u8001\u5E08",open:r,confirmLoading:c.isLoading,onClose:p,onConfirm:d,children:t(D,{fullWidth:!0,multiline:!0,autoFocus:!0,error:i,helperText:i?"\u4E0D\u80FD\u4E3A\u7A7A":"",rows:10,value:a,onChange:m=>s(m.target.value)})})]})}var Be=(e=>(e.Write="003001",e.Select="003002",e))(Be||{});function Pr(e){return S.post("/exam/search",e)}function $r(e){return S.post("/exam/detail",{id:e})}function Rr(e){return S.post("/exam/commit",e)}var Nr="/assets/examCover.268c2a87.png";function zr(){const[e,n]=Ve(),r=ye(),o=e.get("type")||z.English,a=Y(["exams",o],()=>Pr({deptId:r.deptId,subType:o})),s=(l,c)=>{n({type:c})},i=a.data||[];return h(q,{children:[h(fe,{variant:"scrollable",value:o,onChange:s,children:[t(M,{label:"\u82F1\u8BED\u8BFE\u7A0B",value:z.English}),t(M,{label:"\u6C49\u8BED\u8BFE\u7A0B",value:z.Chinese})]}),t(G,{sx:{flex:1,overflow:"auto"},isEmpty:i.length===0,...a,children:t(U,{children:i.map((l,c)=>t(H,{divider:c!==i.length-1,disablePadding:!0,children:h(me,{component:ge,to:`/exam/${l.id}`,state:{title:l.examName},children:[t(Ke,{children:t(Fe,{variant:"square",src:Nr})}),t(_,{primary:l.examName,secondary:`\u5171 ${l.examTotal} \u9898`})]})},l.id))})})]})}var Wr="/assets/exam-success.397f5d8a.png";function Mr({data:e}){const n=O(),{id:r}=T(),[o,a]=u.exports.useState(!1),{current:s,next:i,isLast:l}=ft({data:e}),[c,p]=u.exports.useState(0),[d,f]=u.exports.useState(""),m=s.type===Be.Write&&s.title.includes("#"),g=s.type===Be.Select,v=()=>{if(m)return t(lt,{content:s.title,value:d.split("|"),onChange:F=>f(F.join("|"))});if(g){const F=(s.options||[]).map(Z=>({label:Z.content,value:Z.label}));return t(gt,{value:d,onChange:f,options:F})}return t(D,{placeholder:"\u8F93\u5165\u7B54\u6848",fullWidth:!0,multiline:!0,value:d,onChange:F=>f(F.target.value),variant:"standard"})},y=()=>m?(d.match(/[^|\s]+/g)||[]).length===(s.title.match(/#/g)||[]).length:d.trim()!=="",E=()=>m?d.replace(/\s+\|\s+/g,"|").toLowerCase()===s.answer.toLowerCase():g?d===s.answer:Te(d,s.answer),b=u.exports.useRef(0),k=u.exports.useRef(0);u.exports.useEffect(()=>{b.current=Date.now()},[]);const{mutate:$,isLoading:J}=j(Rr,{onSuccess(){a(!0)}}),ie=()=>{if(y())if(E()||p(F=>F+1),!l)i(),f("");else{const F=Date.now(),Z=(F-b.current)/1e3|0;k.current=Z;const Et={startTime:ae(b.current).format("YYYY-MM-DD HH:mm:ss"),endTime:ae(F).format("YYYY-MM-DD HH:mm:ss"),examTime:Z,examId:r,examNoNum:c,examYesNum:e.length-c};$(Et)}else ne("\u7B54\u6848\u4E0D\u80FD\u4E3A\u7A7A",{variant:"warning",autoHideDuration:2e3})},vt=()=>{n(-1)};return h(oe,{sx:{display:"flex",flexDirection:"column",height:"100%",pt:2},children:[h(x,{sx:{flex:1,overflowY:"auto"},children:[s.attach&&t(se,{attach:s.attach},s.id),!m&&t(C,{variant:"study",mb:1,children:s.title}),v()]}),t(x,{sx:{p:2,display:"flex",justifyContent:"center"},children:t(K,{loading:J,variant:"contained",onClick:ie,children:l?"\u63D0\u4EA4":"\u4E0B\u4E00\u9898"})}),o&&t(pt,{title:"\u8BC4\u6D4B\u5B8C\u6210",cancelButtonText:"\u786E\u5B9A",open:o,onClose:vt,children:h(x,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[t("img",{style:{width:"70%"},src:Wr,alt:""}),h(xe,{direction:"row",spacing:2,children:[h("span",{children:["\u6B63\u786E\uFF1A",e.length-c,"\u9898"]}),h(x,{component:"span",color:"error.main",children:["\u9519\u8BEF\uFF1A",c,"\u9898"]}),h("span",{children:["\u7528\u65F6\uFF1A",it(k.current)]})]})]})})]})}function Or(){const{id:e}=T(),n=I(),r=Y(["examDetail",e],()=>$r(e)),o=ot(n.state)?n.state.title:"\u8BC4\u6D4B",a=r.data||[];return h(x,{sx:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:100,background:"#fff",display:"flex",flexDirection:"column"},children:[t(ct,{primary:!0,title:o}),t(G,{sx:{flex:1,overflow:"auto"},...r,children:a.length>0&&t(Mr,{data:a})})]})}const jr=e=>{if(!e||e.length===0)return[];const n=new Map;return e.forEach(r=>{n.has(r.createTime)||n.set(r.createTime,[]),n.get(r.createTime).push(r)}),[...n]};function Ur(){var o;const e=Ie(["examRecord"],({pageParam:a=0})=>kr({page:a,size:10}),{getNextPageParam:a=>{if(a.page<a.totalPages-1)return a.page+1}}),n=((o=e.data)==null?void 0:o.pages.reduce((a,s)=>a.concat(s.content),[]))||[],r=jr(n);return t(q,{children:t(Pe,{fetchNextPage:()=>e.fetchNextPage(),hasNextPage:e.hasNextPage,isLoading:e.isLoading,hasChildren:n.length>0,children:t(U,{children:r.map((a,s)=>t(x,{component:"li",sx:{borderBottom:s===r.length-1?0:1,borderBottomColor:"divider"},children:h("ul",{style:{padding:0,margin:0},children:[t(Je,{sx:{lineHeight:"36px"},children:a[0]}),a[1].map((i,l)=>{const c=Number(i.examYesNum),p=Number(i.examNoNum);return h(H,{children:[t(_,{sx:{whiteSpace:"pre"},primary:`${i.examName}`,secondaryTypographyProps:{display:"flex",flexWrap:"wrap"},secondary:h(w,{children:[h(x,{component:"span",children:["\u6B63\u786E\u6570:",t(x,{component:"span",sx:d=>({color:d.palette.success.main,ml:1}),children:c})]}),h(x,{component:"span",sx:{mx:2},children:["\u9519\u8BEF\u5904:",t(x,{component:"span",sx:d=>({color:d.palette.error.main,ml:1}),children:p})]}),h(x,{component:"span",children:["\u7528\u65F6: ",i.examTimeDesc]})]})}),t(yt,{value:c/(c+p)*100})]},`${a[0]}-${l}`)})]})},`${a[0]}`))})})})}function Hr(){var c;const e=ye(),n=O(),r=I(),{register:o,handleSubmit:a,control:s,formState:{errors:i}}=Se({defaultValues:{gander:"1",realName:""}}),l=j(_n,{onSuccess(p){var f;N.updateUser(p);const d=((f=r.state)==null?void 0:f.from)||"/";n(d,{replace:!0})}});return e?e.registerFlag?t(re,{to:"/",replace:!0}):t(x,{sx:p=>({display:"flex",height:"100%",alignItems:"flex-start",backgroundImage:`url("${Xe}")`,backgroundSize:"cover",backgroundColor:"#fff",[p.breakpoints.down(444)]:{backgroundImage:"none"}}),children:h(oe,{maxWidth:"xs",component:"form",noValidate:!0,onSubmit:a(p=>l.mutate(p)),sx:{display:"flex",flexDirection:"column",py:4,mt:12,backgroundColor:"#fff"},children:[t(C,{variant:"h6",gutterBottom:!0,children:"\u5B8C\u5584\u4E2A\u4EBA\u4FE1\u606F"}),t(D,{margin:"normal",variant:"standard",InputLabelProps:{shrink:!0},required:!0,fullWidth:!0,label:"\u59D3\u540D",autoComplete:"tel",autoFocus:!0,helperText:(c=i.realName)==null?void 0:c.message,error:!!i.realName,...o("realName",{required:"\u8BF7\u8F93\u5165\u59D3\u540D"})}),t(Fn,{control:s,name:"gander",render:({field:p})=>h(kn,{margin:"normal",size:"small",children:[t(Dn,{sx:{transform:"scale(0.75)",transformOrigin:"left top"},children:"\u6027\u522B"}),h(Qe,{row:!0,...p,children:[t(pe,{value:"1",control:t(Ce,{}),label:"\u7537"}),t(pe,{value:"2",control:t(Ce,{}),label:"\u5973"})]})]})}),t(K,{sx:{mt:2},variant:"contained",fullWidth:!0,type:"submit",loadingPosition:"start",startIcon:t(Ae,{}),loading:l.isLoading,children:"\u786E\u8BA4"})]})}):t(re,{to:"/login",replace:!0})}const he=({stepId:e,stepValue:n})=>`step/${e}/${n}`,bt=[{path:"/login",element:t(Kn,{})},{path:"/register",element:t(Hr,{})},{path:"/",element:t(Me,{children:t(Zn,{})}),children:[{index:!0,element:t(re,{to:"textbook",replace:!0})},{path:"textbook",element:t(ir,{}),breadcrumbName:"\u5DF2\u9009\u8BFE\u7A0B"},{path:"alltextbook",element:t(ur,{}),breadcrumbName:"\u5168\u90E8\u8BFE\u7A0B"},...["textbook","alltextbook"].map(e=>({path:`${e}/:type/:textbookId`,element:t(lr,{}),children:[{path:"unit/:unitId",element:t(fr,{}),children:[{path:he({stepId:":stepId",stepValue:":stepValue"}),element:t(Ar,{})}]}]})),{path:"history",element:t(wr,{}),breadcrumbName:"\u5B66\u4E60\u8BB0\u5F55"},{path:"feedback",element:t(Lr,{}),breadcrumbName:"\u5E08\u751F\u4E92\u52A8"},{path:"exams",element:t(zr,{}),breadcrumbName:"\u73B0\u5728\u6D4B\u8BC4"},{path:"recordExam",element:t(Ur,{}),breadcrumbName:"\u6D4B\u8BC4\u8BB0\u5F55"}]},{path:"/exam/:id",element:t(Me,{children:t(Or,{})})}];function _r(){const e=wn(bt);return t(On,{children:e})}const He=V.forwardRef((e,n)=>{const{href:r,...o}=e;return t(ge,{ref:n,to:r,...o})}),de=In({palette:{primary:{...Tn,main:"#ff630f",dark:"#ff870f",contrastText:"#fff"}},components:{MuiLink:{defaultProps:{component:He}},MuiButtonBase:{defaultProps:{LinkComponent:He}},MuiTypography:{defaultProps:{variantMapping:{study:"div"}}}}});de.typography.study={fontSize:"1rem",whiteSpace:"pre-wrap",userSelect:"none",[de.breakpoints.up("sm")]:{fontSize:"1.5rem"},[de.breakpoints.up("lg")]:{fontSize:"1.5rem"}};function Yr({children:e}){return t(Ln,{theme:de,children:e})}function qr(){return t(Yr,{children:h(Pn,{client:et,children:[t($n,{}),t(Rn,{basename:"/",children:t(_r,{})}),t(Nn,{autoHideDuration:1500,anchorOrigin:{vertical:"bottom",horizontal:"left"}})]})})}const Vr=document.getElementById("root");zn.createRoot(Vr).render(t(V.StrictMode,{children:t(qr,{})}));
